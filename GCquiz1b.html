<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drag and Drop Quiz</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .quiz-container, .welcome-container, .leaderboard-container {
            width: 50%;
            margin: auto;
            text-align: center;
        }
        .question {
            margin-bottom: 20px;
        }
        .draggable {
            padding: 10px;
            margin: 5px;
            background-color: #f1f1f1;
            border: 1px solid #ccc;
            cursor: move;
        }
        .dropzone {
            padding: 10px;
            margin: 5px;
            background-color: #e1e1e1;
            border: 1px solid #999;
        }
        .hidden {
            display: none;
        }
        .image-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            grid-gap: 10px;
        }
        .image-grid div {
            position: relative;
        }
        .image-grid img {
            width: 100px;
            height: 100px;
        }
        .tooltip {
            visibility: hidden;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 5px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -60px;
            opacity: 0;
            transition: opacity 0.3s;
            width: 120px;
        }
        .image-grid div:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div id="welcome-container" class="welcome-container">
        <button onclick="location.href='GCgame_hub.html'">Return to Main Menu</button>
        <h1>Twelve Principles of Green Chemistry</h1>
        <h3>The 12 principles of Green Chemistry inspire us to minimise waste, eliminate toxic chemicals from products, and reduce energy use.</h3>
        <h4> Take the quiz to understand Green Chemistry in more detail. Each question has 4 possible answers but one is a decoy. Arrange the answers from most to least important.</h4>
        <div class="image-grid">
            <div>
                <img src=GCp1thumb.jpeg alt="Prevent waste">
                <span class="tooltip">It is better to prevent waste than to treat or clean up waste after it has been created.</span>
            </div>
            <div>
                <img src=GCp2thumb.jpg alt="Atom economy">
                <span class="tooltip">Maximize incorporation of all materials used in the process into the final product.</span>
            </div>
            <div>
                <img src=GCp3thumb.jpg alt="Less hazardous synthesis">
                <span class="tooltip">Generate substances that possess little or no toxicity to human health and the environment.</span>
            </div>
            <div>
                <img src=GCp4thumb.jpeg alt="Benign chemicals">
                <span class="tooltip">Chemical products should be designed to preserve efficacy of function while reducing toxicity.</span>
            </div>
            <div>
                <img src=GCp5thumb.jpeg alt="Auxiliaries">
                <span class="tooltip">The use of solvents, separation agents, etc. should be made unnecessary wherever possible and, innocuous when used.</span>
            </div>
            <div>
                <img src=GCp6thumb.jpeg alt="Energy efficiency">
                <span class="tooltip">Energy requirements should be minimized. Synthetic methods should be conducted at ambient temperature and pressure.</span>
            </div>
            <div>
                <img src=GCp7thumb.jpeg alt="Renewable feedstocks">
                <span class="tooltip">A raw material or feedstock should be renewable rather than depleting whenever technically and economically practicable.</span>
            </div>
            <div>
                <img src=GCp8thumb.jpg alt="Reduce derivatives">
                <span class="tooltip">Avoidable, temporary modification of chemicals should be minimized or avoided if possible, to minimise waste.</span>
            </div>
            <div>
                <img src=GCp9thumb.jpg alt="Catalysis">
                <span class="tooltip">Catalytic reagents (as selective as possible) are superior to stoichiometric reagents.</span>
            </div>
            <div>
                <img src=GCp10thumb.jpeg alt="Degradation">
                <span class="tooltip">Chemical products should break down into innocuous degradation products and do not persist in the environment.</span>
            </div>
            <div>
                <img src=GCp11thumb.jpeg alt="Pollution prevention">
                <span class="tooltip">Use real-time, in-process monitoring to control the formation of hazardous substances.</span>
            </div>
            <div>
                <img src=GCp12thumb.jpeg alt="Accident avoidance">
                <span class="tooltip">Substances should be chosen to minimize the potential for chemical accidents, explosions, and fires.</span>
            </div>
        </div>
        <button onclick="startQuiz()">Start Quiz</button>
    </div>

    <div id="quiz-container" class="quiz-container hidden"> 
        <div id="score-display">Score: 0</div>
        <div id="question-container"></div>
        <button id="submit-button" onclick="checkAnswers()">Submit</button>
        <button id="reset-button" onclick="resetQuiz()">Reset answers</button>
        <button id="return-button" onclick="returnToWelcome()">Return to Start Screen</button>
    </div>

    <div id="leaderboard-container" class="leaderboard-container hidden">
        <h2>Leaderboard</h2>
        <div id="leaderboard"></div>
        <button onclick="returnToWelcome()">Return to Welcome Page</button>
    </div>

    <script>
        const questions = [
            {
                id: 1,
                text: 'Manufacturing processes should be designed to minimise waste. Order these chemical industries from most wasteful to least wasteful.',
                answers: ['Petrochemicals', 'Pharmaceuticals', 'Commodity products'],
                correctOrder: ['Pharmaceuticals', 'Commodity products', 'Petrochemicals'],
                decoy: 'Pigeon fancying',
                explanation: 'The more complex (and expensive) the products, the more elaborate and wasteful the chemistry is. For every kilogram of medicine, 100 kilograms of waste is not unusual. Petrochemical production wastes very little.'
            },
            {
                id: 2,
                text: 'Given a choice of reactions, it is best to choose the process that utilises the most atoms. Rank these reactions by the mass % of atoms incorporated into the product (most to least)',
                answers: ['Reaction A', 'Reaction C', 'Reaction B'],
                correctOrder: ['Reaction C', 'Reaction A', 'Reaction B'],
                decoy: 'Reaction D',
                explanation: 'Dimethyl carbonate (Reaction C) only creates carbon dioxide and water as waste products. Iodomethane (Reaction B) wastes a massive iodine atom. The formaldehyde-formic acid system (Reaction D) is for a different reaction. Note that the efficiency (yield) of these reactions is also important to consider.'
            },
            {
                id: 3,
                text: 'How safe are these process designs? Avoid the Very High Risk system.',
                answers: ['Open design with simple extraction', 'Closed design and tightness ensured', 'Closed processing with possibilities of exposure during filling or cleaning'],
                correctOrder: ['Closed design and tightness ensured', 'Closed processing with possibilities of exposure during filling or cleaning', 'Open design with simple extraction'],
                decoy: 'Open design with natural ventilation',
                explanation: 'Best to use sealed systems to eliminate risk of exposure. "Simple extraction" might be an exhaust fan. "Natural ventilation" is not reliable.'
            },
            {
                id: 4,
                text: 'Which of these personal care ingredients are allowed according to regulation? Place in order of least harmful to most harmful. One ingredient is banned.',
                answers: ['Tetrasodium glutamate diacetate (preservative)', 'Sodium lauryl sulphate (cleaning agent)', 'Linalool (bergamot/lavender fragrance)'],
                correctOrder: ['Tetrasodium glutamate diacetate (preservative)', 'Sodium lauryl sulphate (cleaning agent)', 'Linalool (bergamot/lavender fragrance)'],
                decoy: '4-Hydroxybenzoic acid (preservative)',
                explanation: 'Tetrasodium glutamate diacetate has no health hazards. Sodium lauryl sulphate is an irritant. Linalool may cause allergic reaction (skin sensitisation) and irritation. 4-Hydroxybenzoic acid is a paraben compound and banned from cosmetics.'
            },
            {
                id: 5,
                text: 'Solvent is the wet stuff in paints. The solvent is auxiliary to the active ingredient (the pigment), and should have minimal impact. Rank the following solvents by their climate change impact (lowest to highest).',
                answers: ['Cyrene', 'NMP', 'Hexanes'],
                correctOrder: ['Hexanes', 'Cyrene', 'NMP'],
                decoy: 'Starbons',
                explanation: 'Hexane = 0.9kg-CO2-eq/kg (but toxic), Cyrene = 1.3 kg-CO2-eq/kg, NMP = 3.9 kg-CO2-eq/kg (and toxic). Starbons is a solid carbon material, not a solvent.'
            },
            {
                id: 6,
                text: 'If a reaction takes over 2 days at 60 C, what should you do to save energy? Choose the lowest energy conditions whilst maintaining productivity.',
                answers: ['9 days at 25 C', '1 day at 85 C', 'Half day at 110 C'],
                correctOrder: ['Half day at 110 C','1 day at 85 C', '9 days at 25 C'],
                decoy: '6 days at 35 C',
                explanation: 'Energy requirements are quite specific to each reactor and reaction. In this example the energy use can be halved if the temperature is increased to 110 C. Reactions tend to double in speed with a 10 C increase in temperature. Without heating, the main energy requirment is stirring, but low heating for long periods of time can actually increase total energy use.'
            },
            {
                id: 7,
                text: 'Rank these products by how much renewable material they contain (by %). One product does not meet EU bio-based standards (<20%).',
                answers: ['Seaweed (and other ingredients) toothpaste', 'Soy sandals', 'Biodiesel made from vegetable oils'],
                correctOrder: ['Seaweed (and other ingredients) toothpaste', 'Biodiesel made from vegetable oils', 'Soy sandals'],
                decoy: 'Soy carpet',
                explanation: 'The toothpaste is 100% bio-based (minerals and water are excluded from the calculation). Biodiesel is ~95% bio-based. The sandles are 34% bio-based and the carpet is only 12% bio-based.'
            },
            {
                id: 8,
                text: 'The first lab synthesis of the obscure neutrotoxin Jiadifenolide required 21 reactions, wasting 99% of the chemicals. Rank the optimised processes from most efficient to least.',
                answers: ['17 reactions with 90% of reactant wasted', '15 reactions with 95% of reactant wasted', '8 reactions with 90% of reactant wasted'],
                correctOrder: ['8 reactions with 90% of reactant wasted', '17 reactions with 90% of reactant wasted', '15 reactions with 95% of reactant wasted'],
                decoy: '21 reactions with 99% of reactant wasted',
                explanation: 'Generally, more reactions will be tolerated if it increases how much product is madeed (which can be doubled in this case).'
                //see https://doi.org/10.1039/C8CS00399H 
            },
            {
                id: 9,
                text: 'Catalysts are helpful to speed up reactions but the there is a risk of running out of the metals they are made from. Which choice of catalyst is the least impactful on natural reserves?',
                answers: ['Nickel', 'Cobalt', 'Palladium'],
                correctOrder: ['Nickel', 'Cobalt', 'Palladium'],
                decoy: 'Magnesium',
                explanation: 'We should try to reduce the amount of metal required and choose metals that are naturally abundant. Nickel offers the best ratio here. Magnesium is not a catalyst in this reaction.'
                //Amount of catalyst in reaction vs amount of metal resources
            },
            {
                id: 10,
                text: 'If substances cannot be recovered and recycled they should be biodegradable. Rank the biodegradability of these emollients (moisturiser ingredients). One substance is not biodegradable.',
                answers: ['Diisopropyl adipate (synthetic chemical)', 'Ethyl oleate (derived from vegetable oil)', 'Squalane (made from shark liver oil or olive oil)'],
                correctOrder: ['Diisopropyl adipate (synthetic chemical)', 'Ethyl oleate (derived from vegetable oil)', 'Squalane (made from shark liver oil or olive oil)'],
                decoy: 'Caprylyl methicone (synthetic chemical)',
                explanation: 'Diisopropyl adipate undergoes 90% biodegradation in 14 days (regarded as readily biodegradable). Ethyl oleate is 75% biodegradable in 29 days, which also meets "readily biodegradable" criteria. Squalane is 56% biodegraded over 28 days. Caprylyl methicone is only 10-32% biodegraded in 25 days, failing the criteria for a biodegradable substance.'
            },
            {
                id: 11,
                text: 'Most chemists have no idea what is happening during a reaction. Problems are only noticed after an accident. What measures (A to D) would improve safety the most?',
                answers: ['A', 'B', 'C'],
                correctOrder: ['B', 'A', 'C'],
                decoy: 'D',
                explanation: 'It is best to avoid any hazardous materials in the first place. If they are needed, close monitoring is ideal. Automation can reduce exposure but does not avoid accidents.'
            },
            {
                id: 12,
                text: 'Rank these accident prevention actions from the "Hierarchy of Safety Controls".',
                answers: ['Replace hazardous substances', 'Engineering solutions to minimise exposure', 'Personal protective equipment'],
                correctOrder: ['Replace hazardous substances', 'Engineering solutions to minimise exposure', 'Personal protective equipment'],
                decoy: 'Outsource all processes requiring hazardous substances',
                explanation: 'It is best to avoid any hazardous materials in the first place. If they are needed, exposure should be minimal. PPE is needed when there is a chance of exposure but it is best to redesign processes to eliminate exposure to hazardous chemicals.'
            },
        ];

        let currentQuestionIndex = 0;
        let totalScore = 0;

        function startQuiz() {
            const welcomeContainer = document.getElementById('welcome-container');
            const quizContainer = document.getElementById('quiz-container');
            const leaderboardContainer = document.getElementById('leaderboard-container');
            const submitButton = document.getElementById('submit-button');
            const resetButton = document.getElementById('reset-button');
            const scoreDisplay = document.getElementById('score-display');

            welcomeContainer.classList.add('hidden');
            leaderboardContainer.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            submitButton.classList.remove('hidden');
            resetButton.classList.remove('hidden');
            scoreDisplay.classList.remove('hidden');

            totalScore = 0;
            currentQuestionIndex = 0;
            updateScoreDisplay();
            loadQuestion(currentQuestionIndex);
        }


        function loadQuestion(index) {
            const questionContainer = document.getElementById('question-container');
            questionContainer.innerHTML = ''; // Clear previous question

            const question = questions[index];

            const questionElement = document.createElement('div');
            questionElement.classList.add('question');
            questionElement.id = `question${question.id}`;
            
            const questionText = document.createElement('p');
            questionText.textContent = question.text;
            questionElement.appendChild(questionText);

            const shuffledAnswers = shuffle([...question.answers, question.decoy]);

            // Change the loop to only generate three dropzones
            for (let i = 0; i < 3; i++) {
                const dropzone = document.createElement('div');
                dropzone.classList.add('dropzone');
                dropzone.id = `q${question.id}-dropzone${i+1}`;
                questionElement.appendChild(dropzone);
            }

            shuffledAnswers.forEach((answer, i) => {
                const draggable = document.createElement('div');
                draggable.classList.add('draggable');
                draggable.id = `q${question.id}-answer${i+1}`;
                draggable.draggable = true;
                draggable.textContent = answer;
                questionElement.appendChild(draggable);
            });

            // Add image at the bottom
            const image = document.createElement('img');
            image.src = `image${question.id}.jpg`; // Adjust the image source accordingly
            image.alt = `Question ${question.id} Image`;
            image.style.width = '350px';
            questionElement.appendChild(image);

            questionContainer.appendChild(questionElement);

            addDragAndDropFunctionality();
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function addDragAndDropFunctionality() {
            const draggables = document.querySelectorAll('.draggable');
            const dropzones = document.querySelectorAll('.dropzone');

            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', () => {
                    draggable.classList.add('dragging');
                });

                draggable.addEventListener('dragend', () => {
                    draggable.classList.remove('dragging');
                });
            });

            dropzones.forEach(dropzone => {
                dropzone.addEventListener('dragover', e => {
                    e.preventDefault();
                    const dragging = document.querySelector('.dragging');
                    dropzone.appendChild(dragging);
                });
            });
        }

        function checkAnswers() {
            const question = questions[currentQuestionIndex];
            const answerOrder = [];

            question.correctOrder.forEach((_, i) => {
                const dropzone = document.getElementById(`q${question.id}-dropzone${i+1}`);
                if (dropzone.children.length > 0) {
                    answerOrder.push(dropzone.children[0].textContent);
                } else {
                    answerOrder.push(null);
                }
            });

            let feedback = `Your order: ${answerOrder.join(', ')}\n`;
            let score = 0;
            answerOrder.forEach((answer, index) => {
                if (answer === question.correctOrder[index]) {
                    feedback += `Answer ${index + 1} is correct.\n`;
                    score += getPointsForPosition(index);
                } else if (answer === question.decoy) {
                    feedback += `Answer ${index + 1} is a decoy.\n`;
                    score += -1;
                } else {
                    feedback += `Answer ${index + 1} is incorrect.\n`;
                }
            });

            feedback += `Explanation: ${question.explanation}\n`;

            totalScore += score;
            updateScoreDisplay();
            alert(feedback);

            // Move to next question if there is one
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                loadQuestion(currentQuestionIndex);
            } else {
                alert(`That is the end of the quiz. You scored ${totalScore} out of 120.`);
                displayLeaderboard();
            }
        }

        function getPointsForPosition(position) {
            switch (position) {
                case 0: return 5;
                case 1: return 3;
                case 2: return 2;
                default: return 0;
            }
        }

        function updateScoreDisplay() {
            const scoreDisplay = document.getElementById('score-display');
            scoreDisplay.textContent = `Score: ${totalScore}`;
        }

        function resetQuiz() {
            loadQuestion(currentQuestionIndex);
        }

        function displayLeaderboard() {
            const quizContainer = document.getElementById('quiz-container');
            const leaderboardContainer = document.getElementById('leaderboard-container');

            quizContainer.classList.add('hidden');
            leaderboardContainer.classList.remove('hidden');

            let leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];

            const name = prompt('Enter your name:');
            leaderboard.push({ name, score: totalScore });

            leaderboard.sort((a, b) => b.score - a.score);
            localStorage.setItem('leaderboard', JSON.stringify(leaderboard));

            const leaderboardElement = document.getElementById('leaderboard');
            leaderboardElement.innerHTML = '<ol>' + leaderboard.map(entry => `<li>${entry.name}: ${entry.score}</li>`).join('') + '</ol>';
        }

        function returnToWelcome() {
            totalScore = 0;
            currentQuestionIndex = 0;
            updateScoreDisplay();

            const quizContainer = document.getElementById('quiz-container');
            const welcomeContainer = document.getElementById('welcome-container');
            const leaderboardContainer = document.getElementById('leaderboard-container');
            const submitButton = document.getElementById('submit-button');
            const resetButton = document.getElementById('reset-button');
            const scoreDisplay = document.getElementById('score-display');

            quizContainer.classList.add('hidden');
            leaderboardContainer.classList.add('hidden'); // Hide leaderboard
            welcomeContainer.classList.remove('hidden');
            submitButton.classList.remove('hidden');
            resetButton.classList.remove('hidden');
            scoreDisplay.classList.remove('hidden');

            const questionContainer = document.getElementById('question-container');
            questionContainer.innerHTML = ''; // Clear the question container
        }


        // Initialize welcome page
        document.getElementById('welcome-container').classList.remove('hidden');
    </script>
</body>
</html>